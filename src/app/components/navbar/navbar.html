<nav class="bg-white border-b border-gray-200 shadow-sm sticky top-0 z-50">
  <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
    <div class="flex items-center justify-between h-16 lg:h-20">


      <a routerLink="/" class="flex items-center gap-3 hover:opacity-80 transition-opacity">
        <div class="w-10 h-10 bg-linear-to-br from-[#1D7874] to-[#0e4b48] rounded-lg flex items-center justify-center shadow-lg">
           <svg width="30px" height="30px" viewBox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg">
            <path d="M3 1L0 4V5C0 5 2 6 4 6C6 6 8 5 8 5C8 5 10 6 12 6C14 6 16 5 16 5V4L13 1H3Z" fill="#FFFFFF"/>
            <path fill-rule="evenodd" clip-rule="evenodd" d="M1 15V7.5187C1.81671 7.76457 2.88168 8 4 8C5.3025 8 6.53263 7.68064 7.38246 7.39737C7.60924 7.32177 7.81664 7.24612 8 7.17526C8.18337 7.24612 8.39076 7.32177 8.61754 7.39737C9.46737 7.68064 10.6975 8 12 8C13.1183 8 14.1833 7.76457 15 7.5187V15H7V10H4V15H1ZM12 10H10V13H12V10Z" fill="#FFFFFF"/>
          </svg>
        </div>
        <div>
          <h1 class="text-xl lg:text-2xl font-bold bg-linear-to-r from-gray-900 to-gray-700 bg-clip-text text-transparent tracking-tight">
            SmartShop
          </h1>
          <span class="text-xs text-gray-500 font-medium hidden sm:block">Madagascar</span>
        </div>
      </a>


      <div class="flex-1 max-w-xl mx-4 hidden sm:flex" >
        <div class="flex w-full h-12 rounded-lg shadow-lg border border-gray-300 hover:shadow-xl transition-all duration-200 focus-within:shadow-2xl focus-within:border-orange-400">


          <select name="categorie" [(ngModel)]="categorie1" (change)="onSearch()" class="h-full px-4 py-2 border-r border-gray-200 text-sm bg-gray-50 rounded-l-lg focus:outline-none focus:ring-1 focus:ring-orange-400">
            <option>Toutes</option>
            <option *ngFor="let cat of categorie" [value]="cat._id"> {{ cat.nomCategorie }}</option>
          </select>

          <!-- Input recherche -->
          <input
            type="text"
            name="q"
            [(ngModel)]="q"
            (input)="onSearch()"
            placeholder="Rechercher boutiques, produits..."
            class="flex-1 px-6 py-3 bg-white text-base placeholder-gray-500 focus:outline-none focus:ring-1 focus:ring-orange-400"
          />


          <button
            class="bg-[#1D7874] hover:bg-[#4a8582]  px-6 py-3 rounded-r-lg transition-all duration-200 shadow-md hover:shadow-lg flex items-center justify-center"
          >
            <svg width="30px" height="30px" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
<path d="M15.7955 15.8111L21 21M18 10.5C18 14.6421 14.6421 18 10.5 18C6.35786 18 3 14.6421 3 10.5C3 6.35786 6.35786 3 10.5 3C14.6421 3 18 6.35786 18 10.5Z" stroke="#FFFFFF" stroke-width="3" stroke-linecap="round" stroke-linejoin="round"/>
</svg>
          </button>
        </div>
      </div>


      <button
        aria-label="Menu"
        class="sm:hidden p-2 rounded-lg hover:bg-gray-100 transition-colors"
        (click)="toggleMobileMenu()"
      >
        <div *ngIf="!mobileMenuOpen">
          <svg width="30px" height="30px" viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg" fill="none">
            <path fill="#000000" fill-rule="evenodd" d="M19 4a1 1 0 01-1 1H2a1 1 0 010-2h16a1 1 0 011 1zm0 6a1 1 0 01-1 1H2a1 1 0 110-2h16a1 1 0 011 1zm-1 7a1 1 0 100-2H2a1 1 0 100 2h16z"/>
          </svg>
        </div>
        <div *ngIf="mobileMenuOpen">
          <svg width="30px" height="30px" viewBox="0 0 25 25" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" xmlns:sketch="http://www.bohemiancoding.com/sketch/ns">
                <g id="Page-1" stroke="none" stroke-width="1" fill="none" fill-rule="evenodd" sketch:type="MSPage">
                    <g id="Icon-Set" sketch:type="MSLayerGroup" transform="translate(-467.000000, -1039.000000)" fill="#000000">
                        <path d="M489.396,1061.4 C488.614,1062.18 487.347,1062.18 486.564,1061.4 L479.484,1054.32 L472.404,1061.4 C471.622,1062.18 470.354,1062.18 469.572,1061.4 C468.79,1060.61 468.79,1059.35 469.572,1058.56 L476.652,1051.48 L469.572,1044.4 C468.79,1043.62 468.79,1042.35 469.572,1041.57 C470.354,1040.79 471.622,1040.79 472.404,1041.57 L479.484,1048.65 L486.564,1041.57 C487.347,1040.79 488.614,1040.79 489.396,1041.57 C490.179,1042.35 490.179,1043.62 489.396,1044.4 L482.316,1051.48 L489.396,1058.56 C490.179,1059.35 490.179,1060.61 489.396,1061.4 L489.396,1061.4 Z M485.148,1051.48 L490.813,1045.82 C492.376,1044.26 492.376,1041.72 490.813,1040.16 C489.248,1038.59 486.712,1038.59 485.148,1040.16 L479.484,1045.82 L473.82,1040.16 C472.257,1038.59 469.721,1038.59 468.156,1040.16 C466.593,1041.72 466.593,1044.26 468.156,1045.82 L473.82,1051.48 L468.156,1057.15 C466.593,1058.71 466.593,1061.25 468.156,1062.81 C469.721,1064.38 472.257,1064.38 473.82,1062.81 L479.484,1057.15 L485.148,1062.81 C486.712,1064.38 489.248,1064.38 490.813,1062.81 C492.376,1061.25 492.376,1058.71 490.813,1057.15 L485.148,1051.48 L485.148,1051.48 Z" id="cross" sketch:type="MSShapeGroup">

            </path>
                    </g>
                </g>
            </svg>
        </div>
      </button>


      <div class="hidden sm:flex items-center space-x-4 lg:space-x-6 ml-4">


        <a routerLink="/user/panier" *ngIf="auth.user()?.role === 'USER'" class="relative p-2 hover:bg-gray-100 rounded-full transition-colors group">
          <svg width="24" height="24" viewBox="0 0 24 24" fill="none" class="text-gray-700 group-hover:text-orange-600">
            <path d="M6 2L3 6V20C3 20.55 3.45 21 4 21H20C20.55 21 21 20.55 21 20V6L18 2H6Z" stroke="currentColor" stroke-width="1.5" stroke-linecap="round"/>
            <path d="M3 6H21" stroke="currentColor" stroke-width="1.5" stroke-linecap="round"/>
            <circle cx="13" cy="17" r="1.5" fill="currentColor"/>
            <circle cx="7" cy="17" r="1.5" fill="currentColor"/>
          </svg>
          <div class="absolute -top-1 -right-1 bg-[#1D7874] text-white text-xs w-6 h-6 rounded-full flex items-center justify-center font-bold shadow-lg">
            {{  nombreArticles }}
          </div>
        </a>


        <div class="flex items-center space-x-1 group relative">
          <div *ngIf="auth.getCurrentUserRole()==='user' && auth.isAuthenticated(); else loginButtons" class="relative">


      <div
        class="flex items-center space-x-2 cursor-pointer"
        (click)="toggleUserMenus()"
      >
        <div class="w-8 h-8 bg-linear-to-r from-[#1D7874] to-[#1D7874] rounded-full flex items-center justify-center text-white font-semibold text-sm shadow-lg">
          {{ auth.user()?.name?.at(0) || 'U' }}
        </div>

        <span class="hidden lg:block text-sm font-medium text-gray-700">
          Bonjour, {{ auth.user()?.name }}
        </span>

        <i class="fas fa-chevron-down text-xs text-gray-500"></i>
      </div>


      <div
        *ngIf="userMenuOpen"
        class="absolute right-0 mt-2 w-48 bg-white border border-gray-200 rounded-lg shadow-xl z-50 py-2"
      >
        <a
          routerLink="/user/profile"
          class="block px-4 py-2 text-sm text-gray-700 hover:bg-gray-100"
        >
          Mon Profil
        </a>

        <a
          routerLink="/user/historique-commande"
          class="block px-4 py-2 text-sm text-gray-700 hover:bg-gray-100"
        >
          Mes Commandes
        </a>

        <div class="border-t border-gray-200 my-1"></div>

        <button
          (click)="logout()"
          class="w-full text-left px-4 py-2 text-sm text-red-600 hover:bg-red-50"
        >
          DÃ©connexion
        </button>
      </div>
    </div>



          <ng-template #loginButtons>
            <a routerLink="/insert-user" class=" border-2 text-sm text-gray-600 hover:text-[#1D7874] font-medium hidden md:block px-7 py-2 hover:bg-gray-50 rounded-md transition-colors">
              S'inscrire
            </a>
            <a routerLink="/login" class=" border-2  text-sm font-bold bg-[#1D7874] hover:bg-[#264241] text-white px-6 py-2 rounded-md shadow-sm hover:shadow-md transition-all duration-200">
              Se connecter
            </a>
          </ng-template>
        </div>
      </div>
    </div>
  </div>

  <!-- Mobile search bar -->
  <div *ngIf="mobileMenuOpen" class="sm:hidden border-t border-gray-200 bg-white px-4 py-3">
    <div class="flex gap-2">
      <input

        placeholder="Rechercher..."
        class="flex-1 px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-[#1D7874] focus:border-transparent"
      />
      <button class="bg-[#1D7874] hover:bg-[#1D7874] text-white px-6 py-3 rounded-lg shadow-sm">
        <i class="fas fa-search"></i>
      </button>
    </div>
  </div>

  <!-- Mobile bottom menu -->
  <div
    id="mobile-menu"
    class="sm:hidden absolute top-full left-0 w-full bg-white shadow-lg border-t border-gray-200 py-4 px-4"
    [class.hidden]="!mobileMenuOpen"
  >
    <a routerLink="/" class="block py-3 px-4 hover:bg-gray-50 rounded-lg transition-colors">Accueil</a>
    <a routerLink="/boutiques" class="block py-3 px-4 hover:bg-gray-50 rounded-lg transition-colors">Boutiques</a>
    <a routerLink="/produits" class="block py-3 px-4 hover:bg-gray-50 rounded-lg transition-colors">Produits</a>
  </div>
</nav>

