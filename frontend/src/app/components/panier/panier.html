<h1>{{ auth.user() }}</h1>
<div class="container mx-auto mt-10">
  <div class="sm:flex shadow-md my-10">
    <div class="  w-full  sm:w-3/4 bg-white px-10 py-10">
      <div class="flex justify-between border-b pb-8">
        <h1 class="font-semibold text-2xl">Panier</h1>
        <h2 class="font-semibold text-2xl">{{ produits.length }} Items</h2>

      </div>
      <div *ngFor="let p of produits" class="md:flex items-strech py-8 md:py-10 lg:py-8 border-t border-gray-50">

        <div class="md:w-4/12 2xl:w-1/4 w-full">
          <img [src]="p.image || 'https://via.placeholder.com/150'"
              class="h-full object-center object-cover md:block hidden" />
        </div>

        <div class="md:pl-3 md:w-8/12 2xl:w-3/4 flex flex-col justify-center">

          <p class="text-base font-black leading-none text-gray-800">
            {{ p.nom }}
          </p>

          <div class="flex items-center justify-between w-full">
            <select
              [(ngModel)]="p.quantite"
              [ngModelOptions]="{standalone: true}"
              (change)="modifierQuantite(p.produit, $event)"
              class="py-2 px-1 border border-gray-200 mr-6 focus:outline-none"
            >
              <option *ngFor="let q of getQuantites(p.stock)" [value]="q">
                {{ q }}
              </option>
            </select>
          </div>


          <div class="flex items-center justify-between pt-5">

            <p class="text-xs underline text-red-500 pl-5 cursor-pointer"
              (click)="supprimer(p.produit)">
              Supprimer
            </p>

            <p class="text-base font-black leading-none text-gray-800">
              {{ p.prix * p.quantite | number }} MGA
            </p>

          </div>

        </div>

      </div>



      <a routerLink="/user/acceuil-user" class="flex font-semibold text-indigo-600 text-sm mt-10">
        <svg class="fill-current mr-2 text-indigo-600 w-4" viewBox="0 0 448 512">
          <path
            d="M134.059 296H436c6.627 0 12-5.373 12-12v-56c0-6.627-5.373-12-12-12H134.059v-46.059c0-21.382-25.851-32.09-40.971-16.971L7.029 239.029c-9.373 9.373-9.373 24.569 0 33.941l86.059 86.059c15.119 15.119 40.971 4.411 40.971-16.971V296z" />
        </svg>
        Continuer les achats
      </a>
    </div>
    <div id="summary" class=" w-full   sm:w-1/4   md:w-1/2     px-8 py-10">
      <h1 class="font-semibold text-2xl border-b pb-8">R√©sum√© de la commande</h1>
      <div class="flex justify-between mt-10 mb-5">
        <span class="font-semibold text-sm uppercase">
          Items {{ produits.length }}
        </span>
        <span class="font-semibold text-sm">
          {{ total | number }} MGA
        </span>

      </div>

      <div class="border-t mt-8">
        <div class="flex font-semibold justify-between py-6 text-sm uppercase">
          <span>Prix Total</span>
          <span >{{total | number}} MGA</span>
        </div>
        <!-- MODE DE LIVRAISON -->
<div class="border-t mt-8 pt-6">

  <h2 class="font-semibold text-lg mb-4">Mode de livraison</h2>

  <!-- Choix -->
  <div class="space-y-2">
    <label class="flex items-center gap-2 cursor-pointer">
      <input
        type="radio"
        name="modeLivraison"
        value="retrait"
        [(ngModel)]="modeLivraison"
        (change)="changerModeLivraison()"
      />
      <span>R√©cup√©ration (Akoor)</span>
    </label>

    <label class="flex items-center gap-2 cursor-pointer">
      <input
        type="radio"
        name="modeLivraison"
        value="livraison"
        [(ngModel)]="modeLivraison"
        (change)="changerModeLivraison()"
      />
      <span>Livraison √† domicile</span>
    </label>
  </div>

  <!-- CAS RETRAIT -->
  <div *ngIf="modeLivraison === 'retrait'" class="mt-4 p-3 bg-gray-100 rounded">
    <p class="text-sm font-semibold">Adresse de r√©cup√©ration</p>
    <p class="text-sm text-gray-700">Akoor</p>
  </div>

  <!-- CAS LIVRAISON -->
  <div *ngIf="modeLivraison === 'livraison'" class="mt-4">
    <p class="text-sm font-semibold mb-2">
      S√©lectionnez votre lieu de livraison
    </p>

    <!-- Carte -->
    <div id="map" class="w-full rounded" style="height: 250px;"></div>

    <p *ngIf="adresseLivraison" class="text-xs mt-2 text-green-600">
      üìç {{ adresseLivraison }}
    </p>
  </div>

</div>

        <button (click)="commander()" class=" bg-[#1D7874] font-semibold hover:bg-[#11524e] py-3 text-sm text-white uppercase w-full">
              Passer √† la caisse
            </button>
      </div>
    </div>
  </div>
</div>
